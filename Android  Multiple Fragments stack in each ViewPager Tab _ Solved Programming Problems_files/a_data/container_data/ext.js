(function(){var e=this,aa=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},f=function(a){return"string"==typeof a},h=function(a){return"boolean"==typeof a},k=function(a){return"number"==typeof a},m=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b},ba=function(a,b,c){return a.call.apply(a.bind,arguments)},ca=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,
d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},n=function(a,b,c){n=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ba:ca;return n.apply(null,arguments)},p=function(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var g;c.length&&(g=c.shift());)c.length||void 0===b?d[g]?d=d[g]:d=d[g]={}:d[g]=b},q=function(a,b){function c(){}c.prototype=b.prototype;a.M=b.prototype;a.prototype=new c;a.L=function(a,c,l){for(var C=
Array(arguments.length-2),D=2;D<arguments.length;D++)C[D-2]=arguments[D];return b.prototype[c].apply(a,C)}};var da=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},r=function(a,b){return a<b?-1:a>b?1:0};var t=function(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d};t.prototype.clone=function(){return new t(this.top,this.right,this.bottom,this.left)};var u=function(){this.A=this.A;this.F=this.F};u.prototype.A=!1;var v=function(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);},w=function(a){return(new ea(void 0)).m(a)},ea=function(a){this.a=a};
ea.prototype.m=function(a){var b=[];x(this,a,b);return b.join("")};
var x=function(a,b,c){if(null==b)c.push("null");else{if("object"==typeof b){if("array"==aa(b)){var d=b;b=d.length;c.push("[");for(var g="",l=0;l<b;l++)c.push(g),g=d[l],x(a,a.a?a.a.call(d,String(l),g):g,c),g=",";c.push("]");return}if(b instanceof String||b instanceof Number||b instanceof Boolean)b=b.valueOf();else{c.push("{");l="";for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(g=b[d],"function"!=typeof g&&(c.push(l),fa(d,c),c.push(":"),x(a,a.a?a.a.call(b,d,g):g,c),l=","));c.push("}");return}}switch(typeof b){case "string":fa(b,
c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?String(b):"null");break;case "boolean":c.push(String(b));break;case "function":c.push("null");break;default:throw Error("Unknown type: "+typeof b);}}},ga={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ha=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,fa=function(a,b){b.push('"',a.replace(ha,function(a){var b=ga[a];b||(b="\\u"+(a.charCodeAt(0)|65536).toString(16).substr(1),
ga[a]=b);return b}),'"')};var y=function(a,b){var c=window;c.addEventListener?c.addEventListener(a,b,!1):c.attachEvent&&c.attachEvent("on"+a,b)};var z=function(a,b,c,d,g){u.call(this);this.u=a;this.g=1;this.j=b;this.v=c;this.H=d;this.D=!!g;this.o=Math.random();this.a={};this.f=null;this.C=n(this.G,this)};q(z,u);z.prototype.G=function(a){if(a.origin===this.v&&(this.D||a.source==this.j)){var b=null;try{b=v(a.data)}catch(c){}if(m(b)&&(a=b.i,b.c===this.u&&a!=this.o&&(2!==this.g&&(this.g=2,ia(this),this.f&&(this.f(),this.f=null)),a=b.s,b=b.p,f(a)&&(f(b)||m(b))&&this.a.hasOwnProperty(a))))this.a[a](b)}};
var ia=function(a){var b={};b.c=a.u;b.i=a.o;a.j.postMessage(w(b),a.v)};z.prototype.B=function(){if(1===this.g){try{this.j.postMessage&&ia(this)}catch(a){}window.setTimeout(n(this.B,this),50)}};z.prototype.connect=function(a){a&&(this.f=a);y("message",this.C);this.H&&this.B()};var ja=function(a,b,c){var d={};d.c=a.u;d.i=a.o;d.s=b;d.p=c;a.j.postMessage(w(d),a.v)};var ka=function(a){this.g=a;this.o=null;this.f=this.a=0;this.j=null;this.J="sfchannel"+a},A=function(a){return 1==a.a||2==a.a};var B=function(a,b){this.width=a;this.height=b};B.prototype.clone=function(){return new B(this.width,this.height)};var E;a:{var la=e.navigator;if(la){var ma=la.userAgent;if(ma){E=ma;break a}}E=""};var na=-1!=E.indexOf("Opera"),F=-1!=E.indexOf("Trident")||-1!=E.indexOf("MSIE"),oa=-1!=E.indexOf("Edge"),G=-1!=E.indexOf("Gecko")&&!(-1!=E.toLowerCase().indexOf("webkit")&&-1==E.indexOf("Edge"))&&!(-1!=E.indexOf("Trident")||-1!=E.indexOf("MSIE"))&&-1==E.indexOf("Edge"),pa=-1!=E.toLowerCase().indexOf("webkit")&&-1==E.indexOf("Edge"),qa=function(){var a=e.document;return a?a.documentMode:void 0},H;
a:{var I="",L=function(){var a=E;if(G)return/rv\:([^\);]+)(\)|;)/.exec(a);if(oa)return/Edge\/([\d\.]+)/.exec(a);if(F)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(pa)return/WebKit\/(\S+)/.exec(a);if(na)return/(?:Version)[ \/]?(\S+)/.exec(a)}();L&&(I=L?L[1]:"");if(F){var ra=qa();if(null!=ra&&ra>parseFloat(I)){H=String(ra);break a}}H=I}
var sa=H,ta={},ua=function(a){if(!ta[a]){for(var b=0,c=da(String(sa)).split("."),d=da(String(a)).split("."),g=Math.max(c.length,d.length),l=0;0==b&&l<g;l++){var C=c[l]||"",D=d[l]||"",Ua=RegExp("(\\d*)(\\D*)","g"),Va=RegExp("(\\d*)(\\D*)","g");do{var J=Ua.exec(C)||["","",""],K=Va.exec(D)||["","",""];if(0==J[0].length&&0==K[0].length)break;b=r(0==J[1].length?0:parseInt(J[1],10),0==K[1].length?0:parseInt(K[1],10))||r(0==J[2].length,0==K[2].length)||r(J[2],K[2])}while(0==b)}ta[a]=0<=b}},va=e.document,
wa=va&&F?qa()||("CSS1Compat"==va.compatMode?parseInt(sa,10):5):void 0;var xa;if(!(xa=!G&&!F)){var ya;if(ya=F)ya=9<=Number(wa);xa=ya}xa||G&&ua("1.9.1");F&&ua("9");var za=function(a,b,c,d,g,l){this.f=a.clone();this.a=b.clone();this.u=c;this.g=d.clone();this.j=g;this.o=l},Aa=function(a){a=v(a);if(!(m(a)&&k(a.windowCoords_t)&&k(a.windowCoords_r)&&k(a.windowCoords_b)&&k(a.windowCoords_l)&&k(a.frameCoords_t)&&k(a.frameCoords_r)&&k(a.frameCoords_b)&&k(a.frameCoords_l)&&f(a.styleZIndex)&&k(a.allowedExpansion_t)&&k(a.allowedExpansion_r)&&k(a.allowedExpansion_b)&&k(a.allowedExpansion_l)&&k(a.xInView)&&0<=a.xInView&&1>=a.xInView&&k(a.yInView)&&0<=a.yInView&&1>=a.yInView))throw Error("Cannot parse JSON geometry");
return new za(new t(a.windowCoords_t,a.windowCoords_r,a.windowCoords_b,a.windowCoords_l),new t(a.frameCoords_t,a.frameCoords_r,a.frameCoords_b,a.frameCoords_l),a.styleZIndex,new t(a.allowedExpansion_t,a.allowedExpansion_r,a.allowedExpansion_b,a.allowedExpansion_l),a.xInView,a.yInView)};
za.prototype.m=function(){return w({windowCoords_t:this.f.top,windowCoords_r:this.f.right,windowCoords_b:this.f.bottom,windowCoords_l:this.f.left,frameCoords_t:this.a.top,frameCoords_r:this.a.right,frameCoords_b:this.a.bottom,frameCoords_l:this.a.left,styleZIndex:this.u,allowedExpansion_t:this.g.top,allowedExpansion_r:this.g.right,allowedExpansion_b:this.g.bottom,allowedExpansion_l:this.g.left,xInView:this.j,yInView:this.o})};var M=!1,N=function(a){if(a=a.match(/[\d]+/g))a.length=3};
(function(){if(navigator.plugins&&navigator.plugins.length){var a=navigator.plugins["Shockwave Flash"];if(a&&(M=!0,a.description)){N(a.description);return}if(navigator.plugins["Shockwave Flash 2.0"]){M=!0;return}}if(navigator.mimeTypes&&navigator.mimeTypes.length&&(a=navigator.mimeTypes["application/x-shockwave-flash"],M=!!a&&a.enabledPlugin)){N(a.enabledPlugin.description);return}try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");M=!0;N(b.GetVariable("$version"));return}catch(c){}try{b=
new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");M=!0;return}catch(c){}try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),M=!0,N(b.GetVariable("$version"))}catch(c){}})();var Ba=function(a){this.a=a};Ba.prototype.m=function(){return w(this.a)};var Ca=function(a,b,c,d){this.a=a;this.f=b;this.g=c;this.j=d};Ca.prototype.m=function(){return w({expandByOverlay:this.a,expandByPush:this.f,readCookie:this.g,writeCookie:this.j})};var Da=function(a,b,c,d,g,l,C){this.u=a;this.a=b;this.f=c;this.o=d;this.g=g;this.v=l;this.j=C};Da.prototype.m=function(){var a={uid:this.u,hostPeerName:this.a,initialGeometry:this.f.m(),permissions:this.o.m(),metadata:this.g.m(),reportCreativeGeometry:this.v,isDifferentSourceWindow:this.j};return w(a)};var Ea=/^([^;]+);(\d+);([\s\S]*)$/;var O=function(a){this.a=a},Fa=function(a,b){this.a=a;this.version=b};q(Fa,O);Fa.prototype.m=function(){return w({uid:this.a,version:this.version})};var Ga=function(a,b,c){this.a=a;this.g=b;this.f=c};q(Ga,O);Ga.prototype.m=function(){return w({uid:this.a,initialWidth:this.g,initialHeight:this.f})};var Ha=function(a,b){this.a=a;this.description=b};q(Ha,O);Ha.prototype.m=function(){return w({uid:this.a,description:this.description})};var Ia=function(a,b,c){this.a=a;this.f=b;this.push=c};q(Ia,O);
Ia.prototype.m=function(){return w({uid:this.a,expand_t:this.f.top,expand_r:this.f.right,expand_b:this.f.bottom,expand_l:this.f.left,push:this.push})};var Ja=function(a){this.a=a};q(Ja,O);Ja.prototype.m=function(){return w({uid:this.a})};var P=function(a,b){this.a=a;this.g=b};q(P,O);var Ka=function(a){a=v(a);if(!(m(a)&&k(a.uid)&&f(a.newGeometry)))throw Error("Cannot parse JSON message");var b=Aa(a.newGeometry);return new P(a.uid,b)};
P.prototype.m=function(){var a={uid:this.a,newGeometry:this.g.m()};return w(a)};var La=function(a,b,c,d,g){P.call(this,a,c);this.j=b;this.f=d;this.push=g};q(La,P);La.prototype.m=function(){var a={uid:this.a,success:this.j,newGeometry:this.g.m(),expand_t:this.f.top,expand_r:this.f.right,expand_b:this.f.bottom,expand_l:this.f.left,push:this.push};return w(a)};var Ma=function(a,b,c){this.a=a;this.width=b;this.height=c};q(Ma,O);Ma.prototype.m=function(){return w({uid:this.a,width:this.width,height:this.height})};var R=function(a){ka.call(this,a.u);this.A=a.o;this.I=a.g;this.B=null;this.v=[];this.u=0;this.o=a.f;this.j=new z(this.J,window.parent,a.a,!0,a.j);var b=n(this.G,this);this.j.a.expand_response=b;b=n(this.C,this);this.j.a.collapse_response=b;b=n(this.H,this);this.j.a.geometry_update=b;this.j.connect(n(this.K,this));this.a=1;Q(this,"init_done",new Fa(this.g,"1-0-4"));a.v&&(a=n(R.prototype.F,this),y("load",a),y("resize",a))};q(R,ka);var S=function(a,b){Q(a,"report_error",new Ha(a.g,b))};
R.prototype.K=function(){for(var a=0;a<this.v.length;a++)ja(this.j,this.v[a].type,this.v[a].message.m())};
R.prototype.G=function(a){try{if(2!=this.a)throw Error("Container is not registered");if(3!=this.f)throw Error("Container is not expanding");if(!f(a))throw Error("Could not parse serialized message");var b,c=v(a);if(!(m(c)&&k(c.uid)&&h(c.success)&&f(c.newGeometry)&&k(c.expand_t)&&k(c.expand_r)&&k(c.expand_b)&&k(c.expand_l)&&h(c.push)))throw Error("Cannot parse JSON message");var d=Aa(c.newGeometry);b=new La(c.uid,c.success,d,new t(c.expand_t,c.expand_r,c.expand_b,c.expand_l),c.push);if(this.g!=b.a)throw Error("Wrong source container");
this.f=b.j?2:0;this.o=b.g;T(this,b.j?"expanded":"failed",b.push?"exp-push":"exp-ovr","",{t:b.f.top,r:b.f.right,b:b.f.bottom,l:b.f.left,push:b.push})}catch(g){}};R.prototype.C=function(a){try{if(2!=this.a)throw Error("Container is not registered");if(1!=this.f)throw Error("Container is not collapsing");if(!f(a))throw Error("Could not parse serialized message");var b=Ka(a);if(this.g!=b.a)throw Error("Wrong source container");this.f=0;this.o=b.g;T(this,"collapsed","collapse","",void 0)}catch(c){}};
R.prototype.H=function(a){try{if(!A(this))throw Error("Container is not initialized or registered");if(!f(a))throw Error("Could not parse serialized message");var b=Ka(a);if(this.g!=b.a)throw Error("Wrong source container");this.o=b.g;T(this,"geom-update","","",void 0)}catch(c){}};
var T=function(a,b,c,d,g){if(null!==a.B)try{a.B(b,{cmd:c,reason:d,info:g})}catch(l){S(a,"Could not manage to call user-supplied callback")}},Na=function(a,b,c){setTimeout(n(function(){T(this,"failed",a,b,c)},U),0)},Q=function(a,b,c){2===a.j.g?ja(a.j,b,c.m()):a.v.push({type:b,message:c})},Oa=function(a){var b=new B(document.body.offsetWidth,document.body.offsetHeight);Q(a,"creative_geometry_update",new Ma(a.g,b.width,b.height))};R.prototype.D=function(){2==this.u&&Oa(this);this.u=0};
R.prototype.F=function(){switch(this.u){case 0:Oa(this);setTimeout(n(this.D,this),200);this.u=1;break;case 1:this.u=2}};var Pa=function(a,b,c){if(2==U.a)S(U,"Called register multiple times");else if(!k(a)||0>=a)S(U,"Invalid initial width");else if(!k(b)||0>=b)S(U,"Invalid initial height");else{var d=null;if(null!=c){if("function"!=aa(c)){S(U,"Invalid callback function");return}d=c}c=U;c.a=2;c.B=d;Q(c,"register_done",new Ga(c.g,a,b))}},Qa=function(){return A(U)?{"exp-ovr":U.A.a,"exp-push":U.A.f,"read-cookie":U.A.g,"write-cookie":U.A.j}:(S(U,"Called supports on bad container"),null)},Ra=function(){if(!A(U))return S(U,
"Called geom on bad container"),null;var a=U.o;return{win:{t:a.f.top,r:a.f.right,b:a.f.bottom,l:a.f.left,w:a.f.right-a.f.left,h:a.f.bottom-a.f.top},self:{t:a.a.top,r:a.a.right,b:a.a.bottom,l:a.a.left,w:a.a.right-a.a.left,h:a.a.bottom-a.a.top,z:parseInt(a.u,10),xiv:a.j,yiv:a.o,iv:a.j*a.o},exp:{t:a.g.top,r:a.g.right,b:a.g.bottom,l:a.g.left,xs:!1,yx:!1}}},Sa=function(){if(!A(U))return S(U,"Called inViewPercentage on bad container"),null;var a=U.o;return a.j*a.o*100},Ta=function(){if(!A(U))return S(U,
"Called status on bad container"),null;switch(U.f){case 0:return"collapsed";case 1:return"collapsing";case 2:return"expanded";case 3:return"expanding";default:return null}},Wa=function(a,b){if(!A(U))return S(U,"Called meta on bad container"),null;if(!f(a)||/^[\s\xa0]*$/.test(null==a?"":String(a)))return S(U,"Invalid property name"),null;var c="shared";if(null!=b){if(!f(b)||/^[\s\xa0]*$/.test(null==b?"":String(b)))return S(U,"Invalid owner key"),null;c=b}var d=U.I;return null!=d.a[c]&&null!=d.a[c][a]?
d.a[c][a]:null},Xa=function(a,b){if(2==U.a)if(!f(a)||/^[\s\xa0]*$/.test(a))S(U,"Invalid cookie name");else{if(null!=b){var c;!(c=!m(b)||!f(b.info))&&(c=null!=b.expires)&&(c=b.expires,c=!(m(c)&&"function"==typeof c.getFullYear));if(c){Na("write-cookie","Invalid $sf.ext.cookie arguments",b);S(U,"Invalid cookie data");return}}Na(null!=b?"write-cookie":"read-cookie","$sf.ext.cookie is not supported",b);S(U,"Used unsupported cookie operations")}else S(U,"Called cookie on unregistered container")},Ya=function(a){if(2==
U.a)if(0==U.f)if(m(a)&&(null!=a.t||null!=a.r||null!=a.b||null!=a.l)&&(null==a.t||k(a.t)&&0<=a.t)&&(null==a.r||k(a.r)&&0<=a.r)&&(null==a.b||k(a.b)&&0<=a.b)&&(null==a.l||k(a.l)&&0<=a.l)&&(null==a.push||h(a.push))){var b=new t(a.t||0,a.r||0,a.b||0,a.l||0);a=a.push||!1;var c=U;c.f=3;Q(c,"expand_request",new Ia(c.g,b,a))}else Na(m(a)&&h(a.push)&&1==a.push?"exp-push":"exp-ovr","Invalid $sf.ext.expand arguments",a),S(U,"Invalid expand data");else S(U,"Called expand on uncollapsed container");else S(U,"Called expand on unregistered container")},
Za=function(){if(2==U.a)if(2==U.f){var a=U;a.f=1;Q(a,"collapse_request",new Ja(a.g))}else S(U,"Called collapse on unexpanded container");else S(U,"Called collapse on unregistered container")},$a;var ab=null,V=window;
if(V!=V.parent&&V.parent==V.top){try{var bb=window.name,cb=Ea.exec(bb);if(null===cb)throw Error("Cannot parse serialized data to extract version string");if("1-0-4"!=cb[1])throw Error("Host has different version from ext container");var W=Ea.exec(bb);if(null===W)throw Error("Cannot parse serialized data to extract config");var db=parseInt(W[2],10);if(db>W[3].length)throw Error("Cannot parse serialized data to extract content");var X=v(W[3].substring(db));if(!(m(X)&&k(X.uid)&&f(X.hostPeerName)&&f(X.initialGeometry)&&
f(X.permissions)&&f(X.metadata)&&h(X.reportCreativeGeometry)&&h(X.isDifferentSourceWindow)))throw Error("Cannot parse JSON config");var eb=Aa(X.initialGeometry),fb,Y=v(X.permissions);if(!(m(Y)&&h(Y.expandByOverlay)&&h(Y.expandByPush)&&h(Y.readCookie)&&h(Y.writeCookie)))throw Error("Cannot parse JSON permissions");fb=new Ca(Y.expandByOverlay,Y.expandByPush,Y.readCookie,Y.writeCookie);var Z=v(X.metadata);if(!(m(Z)&&m(Z.shared)&&f(Z.shared.sf_ver)&&k(Z.shared.ck_on)&&f(Z.shared.flash_ver)))throw Error("Cannot parse JSON metadata");
ab=new R(new Da(X.uid,X.hostPeerName,eb,fb,new Ba({shared:{sf_ver:Z.shared.sf_ver,ck_on:Z.shared.ck_on,flash_ver:Z.shared.flash_ver}}),X.reportCreativeGeometry,X.isDifferentSourceWindow));p("$sf.ext.register",Pa);p("$sf.ext.supports",Qa);p("$sf.ext.geom",Ra);p("$sf.ext.inViewPercentage",Sa);p("$sf.ext.status",Ta);p("$sf.ext.meta",Wa);p("$sf.ext.cookie",Xa);p("$sf.ext.expand",Ya);p("$sf.ext.collapse",Za)}catch(a){}window.name="";$a=ab}else $a=null;var U=$a;})();
