!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.DMVAST=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],2:[function(a,b,c){var d;d=function(){function a(){this.id=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[],this.extensions=[]}return a}(),b.exports=d},{}],3:[function(a,b,c){var d,e,f;e=a("./parser"),f=a("./util"),d=function(){function a(){}return a.cappingFreeLunch=0,a.cappingMinimumTimeInterval=0,a.options={withCredentials:!1,timeout:0},a.get=function(a,b,d){var f,g,h;return g=+new Date,f=c.extend=function(a,b){var c,d;for(c in b)d=b[c],a[c]=d;return a},d||("function"==typeof b&&(d=b),h={}),h=f(this.options,b),this.totalCallsTimeout<g?(this.totalCalls=1,this.totalCallsTimeout=g+36e5):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls?void d(null):g-this.lastSuccessfullAd<this.cappingMinimumTimeInterval?void d(null):e.parse(a,h,function(a){return function(a){return d(a)}}(this))},function(){var b,c;c=f.storage,b=Object.defineProperty,["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forEach(function(d){b(a,d,{get:function(){return c.getItem(d)},set:function(a){return c.setItem(d,a)},configurable:!1,enumerable:!0})}),null==a.totalCalls&&(a.totalCalls=0),null==a.totalCallsTimeout&&(a.totalCallsTimeout=0)}(),a}(),b.exports=d},{"./parser":10,"./util":16}],4:[function(a,b,c){var d;d=function(){function a(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.companionClickThroughURLTemplate=null,this.trackingEvents={}}return a}(),b.exports=d},{}],5:[function(a,b,c){var d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=function(){function a(){this.trackingEvents={}}return a}(),f=function(a){function b(){b.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplates=[],this.videoCustomClickURLTemplates=[],this.adParameters=null}return i(b,a),b}(d),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b}(d),e=function(a){function b(){this.type="companion",this.variations=[],this.videoClickTrackingURLTemplates=[]}return i(b,a),b}(d),b.exports={VASTCreativeLinear:f,VASTCreativeNonLinear:g,VASTCreativeCompanion:e}},{}],6:[function(a,b,c){var d;d=function(){function a(){this.attributes={},this.children=[]}return a}(),b.exports=d},{}],7:[function(a,b,c){var d;d=function(){function a(){this.name=null,this.value=null,this.attributes={}}return a}(),b.exports=d},{}],8:[function(a,b,c){b.exports={client:a("./client"),tracker:a("./tracker"),parser:a("./parser"),util:a("./util"),urlhandler:a("./urlhandler")}},{"./client":3,"./parser":10,"./tracker":12,"./urlhandler":13,"./util":16}],9:[function(a,b,c){var d;d=function(){function a(){this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null}return a}(),b.exports=d},{}],10:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};e=a("./urlhandler"),n=a("./response"),f=a("./ad"),g=a("./extension"),h=a("./extensionchild"),o=a("./util"),k=a("./creative").VASTCreativeLinear,j=a("./creative").VASTCreativeCompanion,l=a("./mediafile"),i=a("./companionad"),d=a("events").EventEmitter,m=function(){function a(){}var b;return b=[],a.addURLTemplateFilter=function(a){"function"==typeof a&&b.push(a)},a.removeURLTemplateFilter=function(){return b.pop()},a.countURLTemplateFilters=function(){return b.length},a.clearUrlTemplateFilters=function(){return b=[]},a.parse=function(a,b,c){return c||("function"==typeof b&&(c=b),b={}),this._parse(a,null,b,function(a,b){return c(b)})},a.vent=new d,a.track=function(a,b){return this.vent.emit("VAST-error",b),o.track(a,b)},a.on=function(a,b){return this.vent.on(a,b)},a.once=function(a,b){return this.vent.once(a,b)},a._parse=function(a,c,d,f){var g,h,i;for(f||("function"==typeof d&&(f=d),d={}),h=0,i=b.length;h<i;h++)g=b[h],a=g(a);return null==c&&(c=[]),c.push(a),e.get(a,d,function(b){return function(e,g){var h,i,j,k,l,m,o,q,r,s,t;if(null!=e)return f(e);if(l=new n,null==(null!=g?g.documentElement:void 0)||"VAST"!==g.documentElement.nodeName)return f();for(s=g.documentElement.childNodes,m=0,q=s.length;m<q;m++)k=s[m],"Error"===k.nodeName&&l.errorURLTemplates.push(b.parseNodeText(k));for(t=g.documentElement.childNodes,o=0,r=t.length;o<r;o++)k=t[o],"Ad"===k.nodeName&&(h=b.parseAdElement(k),null!=h?l.ads.push(h):b.track(l.errorURLTemplates,{ERRORCODE:101}));for(i=function(a){var c,d,e;if(null==a&&(a=!1),l){for(e=l.ads,c=0,d=e.length;c<d;c++)if(h=e[c],null!=h.nextWrapperURL)return;return 0===l.ads.length&&(a||b.track(l.errorURLTemplates,{ERRORCODE:303}),l=null),f(null,l)}},j=l.ads.length;j--;)h=l.ads[j],null!=h.nextWrapperURL&&!function(e){var f,g;return c.length>=10||(g=e.nextWrapperURL,p.call(c,g)>=0)?(b.track(e.errorURLTemplates,{ERRORCODE:302}),l.ads.splice(l.ads.indexOf(e),1),void i()):(e.nextWrapperURL.indexOf("://")===-1&&(f=a.slice(0,a.lastIndexOf("/")),e.nextWrapperURL=""+f+"/"+e.nextWrapperURL),b._parse(e.nextWrapperURL,c,d,function(a,c){var d,f,g,h,j,k,m,n,o,p,q,r,s,t,u,v,w,x;if(f=!1,null!=a)b.track(e.errorURLTemplates,{ERRORCODE:301}),l.ads.splice(l.ads.indexOf(e),1),f=!0;else if(null==c)b.track(e.errorURLTemplates,{ERRORCODE:303}),l.ads.splice(l.ads.indexOf(e),1),f=!0;else for(l.errorURLTemplates=l.errorURLTemplates.concat(c.errorURLTemplates),h=l.ads.indexOf(e),l.ads.splice(h,1),u=c.ads,m=0,n=u.length;m<n;m++){if(j=u[m],j.errorURLTemplates=e.errorURLTemplates.concat(j.errorURLTemplates),j.impressionURLTemplates=e.impressionURLTemplates.concat(j.impressionURLTemplates),null!=e.trackingEvents)for(v=j.creatives,r=0,o=v.length;r<o;r++)if(d=v[r],"linear"===d.type)for(w=Object.keys(e.trackingEvents),s=0,p=w.length;s<p;s++)g=w[s],(k=d.trackingEvents)[g]||(k[g]=[]),d.trackingEvents[g]=d.trackingEvents[g].concat(e.trackingEvents[g]);if(null!=e.videoClickTrackingURLTemplates)for(x=j.creatives,t=0,q=x.length;t<q;t++)d=x[t],"linear"===d.type&&(d.videoClickTrackingURLTemplates=d.videoClickTrackingURLTemplates.concat(e.videoClickTrackingURLTemplates));l.ads.splice(h,0,j)}return delete e.nextWrapperURL,i(f)}))}(h);return i()}}(this))},a.childByName=function(a,b){var c,d,e,f;for(f=a.childNodes,d=0,e=f.length;d<e;d++)if(c=f[d],c.nodeName===b)return c},a.childsByName=function(a,b){var c,d,e,f,g;for(d=[],g=a.childNodes,e=0,f=g.length;e<f;e++)c=g[e],c.nodeName===b&&d.push(c);return d},a.parseAdElement=function(a){var b,c,d,e;for(e=a.childNodes,c=0,d=e.length;c<d;c++){if(b=e[c],b.id=a.getAttribute("id"),"Wrapper"===b.nodeName)return this.parseWrapperElement(b);if("InLine"===b.nodeName)return this.parseInLineElement(b)}},a.parseWrapperElement=function(a){var b,c,d,e,f,g,h;for(b=this.parseInLineElement(a),e=this.childByName(a,"VASTAdTagURI"),null!=e?b.nextWrapperURL=this.parseNodeText(e):(e=this.childByName(a,"VASTAdTagURL"),null!=e&&(b.nextWrapperURL=this.parseNodeText(this.childByName(e,"URL")))),d=null,h=b.creatives,f=0,g=h.length;f<g;f++)if(c=h[f],"linear"===c.type){d=c;break}if(null!=d&&(null!=d.trackingEvents&&(b.trackingEvents=d.trackingEvents),null!=d.videoClickTrackingURLTemplates&&(b.videoClickTrackingURLTemplates=d.videoClickTrackingURLTemplates)),null!=b.nextWrapperURL)return b},a.parseInLineElement=function(a){var b,c,d,e,g,h,i,j,k,l,m,n,o,p;for(b=new f,b.id=a.id,n=a.childNodes,h=0,k=n.length;h<k;h++)switch(g=n[h],g.nodeName){case"Error":this.isUrl(g)&&b.errorURLTemplates.push(this.parseNodeText(g));break;case"Impression":this.isUrl(g)&&b.impressionURLTemplates.push(this.parseNodeText(g));break;case"Creatives":for(o=this.childsByName(g,"Creative"),i=0,l=o.length;i<l;i++)for(d=o[i],p=d.childNodes,j=0,m=p.length;j<m;j++)switch(e=p[j],e.nodeName){case"Linear":c=this.parseCreativeLinearElement(e),c&&b.creatives.push(c);break;case"CompanionAds":c=this.parseCompanionAd(e),c&&b.creatives.push(c)}break;case"Extensions":this.parseExtension(b.extensions,this.childsByName(g,"Extension"))}return b},a.parseExtension=function(a,b){var c,d,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v;for(v=[],k=0,o=b.length;k<o;k++){if(i=b[k],d=new g,i.attributes)for(s=i.attributes,l=0,p=s.length;l<p;l++)j=s[l],d.attributes[j.nodeName]=j.nodeValue;for(t=i.childNodes,m=0,q=t.length;m<q;m++)if(c=t[m],"#text"!==c.nodeName){if(e=new h,e.name=c.nodeName,e.value=this.parseNodeText(c),c.attributes)for(u=c.attributes,n=0,r=u.length;n<r;n++)f=u[n],e.attributes[f.nodeName]=f.nodeValue;d.children.push(e)}v.push(a.push(d))}return v},a.parseCreativeLinearElement=function(a){var b,c,d,e,f,g,h,i,j,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;if(d=new k,d.duration=this.parseDuration(this.parseNodeText(this.childByName(a,"Duration"))),d.duration===-1&&"Wrapper"!==a.parentNode.parentNode.parentNode.nodeName)return null;if(p=a.getAttribute("skipoffset"),null==p?d.skipDelay=null:"%"===p.charAt(p.length-1)?(n=parseInt(p,10),d.skipDelay=d.duration*(n/100)):d.skipDelay=this.parseDuration(p),t=this.childByName(a,"VideoClicks"),null!=t){for(d.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(t,"ClickThrough")),H=this.childsByName(t,"ClickTracking"),v=0,z=H.length;v<z;v++)c=H[v],d.videoClickTrackingURLTemplates.push(this.parseNodeText(c));for(I=this.childsByName(t,"CustomClick"),w=0,A=I.length;w<A;w++)e=I[w],d.videoCustomClickURLTemplates.push(this.parseNodeText(e))}for(b=this.childByName(a,"AdParameters"),null!=b&&(d.adParameters=this.parseNodeText(b)),J=this.childsByName(a,"TrackingEvents"),x=0,B=J.length;x<B;x++)for(r=J[x],K=this.childsByName(r,"Tracking"),y=0,C=K.length;y<C;y++)if(q=K[y],f=q.getAttribute("event"),s=this.parseNodeText(q),null!=f&&null!=s){if("progress"===f){if(m=q.getAttribute("offset"),!m)continue;f="%"===m.charAt(m.length-1)?"progress-"+m:"progress-"+Math.round(this.parseDuration(m))}null==(u=d.trackingEvents)[f]&&(u[f]=[]),d.trackingEvents[f].push(s)}for(L=this.childsByName(a,"MediaFiles"),F=0,D=L.length;F<D;F++)for(j=L[F],M=this.childsByName(j,"MediaFile"),G=0,E=M.length;G<E;G++)i=M[G],h=new l,h.id=i.getAttribute("id"),h.fileURL=this.parseNodeText(i),h.deliveryType=i.getAttribute("delivery"),h.codec=i.getAttribute("codec"),h.mimeType=i.getAttribute("type"),h.apiFramework=i.getAttribute("apiFramework"),h.bitrate=parseInt(i.getAttribute("bitrate")||0),h.minBitrate=parseInt(i.getAttribute("minBitrate")||0),h.maxBitrate=parseInt(i.getAttribute("maxBitrate")||0),h.width=parseInt(i.getAttribute("width")||0),h.height=parseInt(i.getAttribute("height")||0),o=i.getAttribute("scalable"),o&&"string"==typeof o&&(o=o.toLowerCase(),"true"===o?h.scalable=!0:"false"===o&&(h.scalable=!1)),g=i.getAttribute("maintainAspectRatio"),g&&"string"==typeof g&&(g=g.toLowerCase(),"true"===g?h.maintainAspectRatio=!0:"false"===g&&(h.maintainAspectRatio=!1)),d.mediaFiles.push(h);return d},a.parseCompanionAd=function(a){var b,c,d,e,f,g,h,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;for(d=new j,A=this.childsByName(a,"Companion"),o=0,s=A.length;o<s;o++){for(c=A[o],b=new i,b.id=c.getAttribute("id")||null,b.width=c.getAttribute("width"),b.height=c.getAttribute("height"),B=this.childsByName(c,"HTMLResource"),p=0,t=B.length;p<t;p++)f=B[p],b.type=f.getAttribute("creativeType")||"text/html",b.htmlResource=this.parseNodeText(f);for(C=this.childsByName(c,"IFrameResource"),q=0,u=C.length;q<u;q++)g=C[q],b.type=g.getAttribute("creativeType")||0,b.iframeResource=this.parseNodeText(g);for(D=this.childsByName(c,"StaticResource"),r=0,v=D.length;r<v;r++)h=D[r],b.type=h.getAttribute("creativeType")||0,b.staticResource=this.parseNodeText(h);for(E=this.childsByName(c,"TrackingEvents"),y=0,w=E.length;y<w;y++)for(l=E[y],F=this.childsByName(l,"Tracking"),z=0,x=F.length;z<x;z++)k=F[z],e=k.getAttribute("event"),m=this.parseNodeText(k),null!=e&&null!=m&&(null==(n=b.trackingEvents)[e]&&(n[e]=[]),b.trackingEvents[e].push(m));b.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(c,"CompanionClickThrough")),d.variations.push(b)}return d},a.parseDuration=function(a){var b,c,d,e,f;return null==a?-1:(b=a.split(":"),3!==b.length?-1:(f=b[2].split("."),e=parseInt(f[0]),2===f.length&&(e+=parseFloat("0."+f[1])),d=parseInt(60*b[1]),c=parseInt(60*b[0]*60),isNaN(c||isNaN(d||isNaN(e||d>3600||e>60)))?-1:c+d+e))},a.parseNodeText=function(a){return a&&(a.textContent||a.text||"").trim()},a.isUrl=function(a){return/^https?:\/\/[^\s\/$\.\?#].*$/i.test(this.parseNodeText(a))},a}(),b.exports=m},{"./ad":2,"./companionad":4,"./creative":5,"./extension":6,"./extensionchild":7,"./mediafile":9,"./response":11,"./urlhandler":13,"./util":16,events:1}],11:[function(a,b,c){var d;d=function(){function a(){this.ads=[],this.errorURLTemplates=[]}return a}(),b.exports=d},{}],12:[function(a,b,c){var d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("./client"),h=a("./util"),f=a("./creative").VASTCreativeLinear,d=a("events").EventEmitter,g=function(a){function b(a,b){var c,d,g;this.ad=a,this.creative=b,this.muted=!1,this.impressed=!1,this.skipable=!1,this.skipDelayDefault=-1,this.trackingEvents={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],g=this.creative.trackingEvents;for(c in g)d=g[c],this.trackingEvents[c]=d.slice(0);this.creative instanceof f?(this.setDuration(this.creative.duration),this.skipDelay=this.creative.skipDelay,this.linear=!0,this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates):(this.skipDelay=-1,this.linear=!1),this.on("start",function(){e.lastSuccessfullAd=+new Date})}return j(b,a),b.prototype.setDuration=function(a){return this.assetDuration=a,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}},b.prototype.setProgress=function(a){var b,c,d,e,f,g,h,i,j;if(f=null===this.skipDelay?this.skipDelayDefault:this.skipDelay,f===-1||this.skipable||(f>a?this.emit("skip-countdown",f-a):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&this.assetDuration>0){if(c=[],a>0){c.push("start"),d=Math.round(a/this.assetDuration*100),c.push("progress-"+d+"%"),c.push("progress-"+Math.round(a)),j=this.quartiles;for(e in j)g=j[e],g<=a&&a<=g+1&&c.push(e)}for(h=0,i=c.length;h<i;h++)b=c[h],this.track(b,!0);a<this.progress&&this.track("rewind")}return this.progress=a},b.prototype.setMuted=function(a){return this.muted!==a&&this.track(a?"mute":"unmute"),this.muted=a},b.prototype.setPaused=function(a){return this.paused!==a&&this.track(a?"pause":"resume"),this.paused=a},b.prototype.setFullscreen=function(a){return this.fullscreen!==a&&this.track(a?"fullscreen":"exitFullscreen"),this.fullscreen=a},b.prototype.setSkipDelay=function(a){if("number"==typeof a)return this.skipDelay=a},b.prototype.load=function(){if(!this.impressed)return this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView")},b.prototype.errorWithCode=function(a){return this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:a})},b.prototype.complete=function(){return this.track("complete")},b.prototype.stop=function(){return this.track(this.linear?"closeLinear":"close")},b.prototype.skip=function(){return this.track("skip"),this.trackingEvents=[]},b.prototype.click=function(){var a,b,c;if((null!=(c=this.clickTrackingURLTemplates)?c.length:void 0)&&this.trackURLs(this.clickTrackingURLTemplates),null!=this.clickThroughURLTemplate)return this.linear&&(b={CONTENTPLAYHEAD:this.progressFormated()}),a=h.resolveURLTemplates([this.clickThroughURLTemplate],b)[0],this.emit("clickthrough",a)},b.prototype.track=function(a,b){var c,d;null==b&&(b=!1),"closeLinear"===a&&null==this.trackingEvents[a]&&null!=this.trackingEvents.close&&(a="close"),d=this.trackingEvents[a],c=this.emitAlwaysEvents.indexOf(a),null!=d?(this.emit(a,""),this.trackURLs(d)):c!==-1&&this.emit(a,""),b===!0&&(delete this.trackingEvents[a],c>-1&&this.emitAlwaysEvents.splice(c,1))},b.prototype.trackURLs=function(a,b){return null==b&&(b={}),this.linear&&(b.CONTENTPLAYHEAD=this.progressFormated()),h.track(a,b)},b.prototype.progressFormated=function(){var a,b,c,d,e;return e=parseInt(this.progress),a=e/3600,a.length<2&&(a="0"+a),b=e/60%60,b.length<2&&(b="0"+b),d=e%60,d.length<2&&(d="0"+b),c=parseInt(100*(this.progress-e)),""+a+":"+b+":"+d+"."+c},b}(d),b.exports=g},{"./client":3,"./creative":5,"./util":16,events:1}],13:[function(a,b,c){var d,e,f;f=a("./urlhandlers/xmlhttprequest"),e=a("./urlhandlers/flash"),d=function(){function b(){}return b.get=function(b,c,d){return d||("function"==typeof c&&(d=c),c={}),c.urlhandler&&c.urlhandler.supported()?c.urlhandler.get(b,c,d):"undefined"==typeof window||null===window?a("./urlhandlers/node").get(b,c,d):f.supported()?f.get(b,c,d):e.supported()?e.get(b,c,d):d()},b}(),b.exports=d},{"./urlhandlers/flash":14,"./urlhandlers/xmlhttprequest":15}],14:[function(a,b,c){var d;d=function(){function a(){}return a.xdr=function(){var a;return window.XDomainRequest&&(a=new XDomainRequest),a},a.supported=function(){return!!this.xdr()},a.get=function(a,b,c){var d,e;return(e="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(e.async=!1,d=this.xdr(),d.open("GET",a),d.timeout=b.timeout||0,d.withCredentials=b.withCredentials||!1,d.send(),d.onprogress=function(){},d.onload=function(){return e.loadXML(d.responseText),c(null,e)}):c()},a}(),b.exports=d},{}],15:[function(a,b,c){var d;d=function(){function a(){}return a.xhr=function(){var a;if(a=new window.XMLHttpRequest,"withCredentials"in a)return a},a.supported=function(){return!!this.xhr()},a.get=function(a,b,c){var d;try{return d=this.xhr(),d.open("GET",a),d.timeout=b.timeout||0,d.withCredentials=b.withCredentials||!1,d.send(),d.onreadystatechange=function(){if(4===d.readyState)return c(null,d.responseXML)}}catch(a){return c()}},a}(),b.exports=d},{}],16:[function(a,b,c){var d;d=function(){function a(){}return a.track=function(a,b){var c,d,e,f,g,h;for(d=this.resolveURLTemplates(a,b),h=[],f=0,g=d.length;f<g;f++)c=d[f],"undefined"!=typeof window&&null!==window&&(e=new Image,h.push(e.src=c));return h},a.resolveURLTemplates=function(a,b){var c,d,e,f,g,h,i,j,k;d=[],null==b&&(b={}),"CACHEBUSTING"in b||(b.CACHEBUSTING=Math.round(1e10*Math.random())),b.random=b.CACHEBUSTING;for(j=0,k=a.length;j<k;j++)if(c=a[j],h=c){for(e in b)i=b[e],f="["+e+"]",g="%%"+e+"%%",h=h.replace(f,i),h=h.replace(g,i);d.push(h)}return d},a.storage=function(){var a,b,c,d;try{c="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(a){d=a,c=null}return b=function(a){var b,c;try{if(c="__VASTUtil__",a.setItem(c,c),a.getItem(c)!==c)return!0}catch(a){return b=a,!0}return!1},(null==c||b(c))&&(a={},c={length:0,getItem:function(b){return a[b]},setItem:function(b,c){a[b]=c,this.length=Object.keys(a).length},removeItem:function(b){delete a[b],this.length=Object.keys(a).length},clear:function(){a={},this.length=0}}),c}(),a}(),b.exports=d},{}]},{},[8])(8)});var AltitudeDigital=AltitudeDigital||{};AltitudeDigital.Utils=AltitudeDigital.Utils||function(){var a=void 0!==window.ActiveXObject,b="alt-iframe-",c=["rockyou.com","gourmetads.com"],d=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return!!b&&"HTML"!==b.nodeName},e=function(a){for(var b=[],c=a.length;c--;b.unshift(a[c]));return b},f=!1,g=function(a,b){try{var c=(new Error).stack.split("\n")}catch(b){return a}for(var d=/(?:^|\s|\.)AltitudeDigital\.(.*?)\.(.*)(\(.*)/,e=!1,f=3;f<c.length;f++)if(d.test(c[f])){var g=d.exec(c[f]),i=g[1];if("Utils"==i){e=!~c[f].indexOf(".log.");continue}return i=e?i+"::Utils":i,b?i:h(i,a)}return a},h=function(a,b){if(""==a)return b;var c=Array.prototype.slice.call(b);return c[0]="["+a+"] "+c[0],c},i=function(){if(arguments&&f)return console.log.apply(console,g(arguments))};i.constructor.prototype.raw=function(){if(f){if(1!=arguments.length){for(var a in arguments){if(d(arguments[a])&&console.dirxml)return console.dirxml.apply(console,arguments);if(arguments[a]instanceof Object)return console.log.apply(console,arguments)}return console.log.apply(console,arguments)}if("string"==typeof arguments[0])return console.log.apply(console,arguments);if(d(arguments[0])&&console.dirxml)return console.dirxml.apply(console,arguments);console.log("%O",arguments)}},i.constructor.prototype.warn=function(){f&&console.warn.apply(console,g(arguments))},i.constructor.prototype.info=function(){f&&console.info.apply(console,g(arguments))},i.constructor.prototype.error=function(){f&&console.error.apply(console,g(arguments))},i.constructor.prototype.table=function(){f&&console.table&&console.table.apply(console,arguments)},i.constructor.prototype.time=function(){f&&console.time&&console.time.apply(console,g(arguments))},i.constructor.prototype.endTime=function(){f&&console.timeEnd&&console.timeEnd.apply(console,g(arguments))},i.constructor.prototype.custom=function(a,b,c){f&&(c=c?c:"fff",i("%c "+a+" ","background:"+c+";color:"+b+";"))},i.constructor.prototype.tiny=function(){if(f){var a=Array.prototype.slice.call(arguments);a[0]="%c "+a[0],a.splice(1,0,"font-size:5pt;"),console.log.apply(console,a)}},i.constructor.prototype.notify=function(){if(f){var a=Array.prototype.slice.call(arguments);a[0]="%c "+a[0],a.splice(1,0,"background:silver;color:blue;"),console.log.apply(console,g(a))}},i.constructor.prototype.black=function(){if(f){var a=Array.prototype.slice.call(arguments);a[0]="%c "+a[0],a.splice(1,0,"background:#222;color:#bada55; padding:2px;"),console.log.apply(console,g(a))}},i.constructor.prototype.startGroup=function(a,b){f&&console.group&&(b=!!b,b?console.group("["+g(null,!0)+"] "+a):console.groupCollapsed("["+g(null,!0)+"] "+a))},i.constructor.prototype.endGroup=function(){f&&console.groupEnd&&console.groupEnd()};var j=function(a){return"bool"==typeof a?(f=a,void i("Logging: ",f)):(f="silent"!=a,"undefined"==typeof console&&(f=!1),console.table||i.warn("Full console capabilities not present. Logging may not show all messages"),void i("Logging: ",f))},k=function(a){return"undefined"==typeof a||null===a},l=function(a){return!k(a)&&Array.isArray(a)},m=function(a,b,c){var d=setTimeout(function(){b=function(){},c()},a),e=function(){clearTimeout(d),b.apply(this,arguments)};return e},n=function(){var a=function(a){return!(!k(a)&&""!=a)},b=function(a){return"string"==typeof a||a instanceof String},c=function(a){return k(a)?"":a},d=function(a,b){return k(a)?b:a},e=function(a,b){return~a.indexOf(b)},f=function(b){return!a(b)&&("1"==b||"true"==b||"t"==b)},g=function(b){var c=b,d=!1,e=!1,f={trimResults:function(){return d=!0,f},omitEmptyStrings:function(){return e=!0,f},split:function(b){var f=new Array;if(!a(b)){var g=b.split(c);o.each(g,function(b){if(!a(b)&&d)try{b=b.trim()}catch(a){}e&&a(b)||f.push(b)})}return f}};return f},h=function(b){var c=b,d=!1,e=!1,f={skipNulls:function(){return d=!0,f},nullsToEmpty:function(){return e=!0,f},join:function(b){var f=new Array;return o.each(b,function(b){var c=b;d&&k(b)||(e&&a(b)&&(c=""),f.push(c))}),f.join(c)}};return f},i=function(a,b){var d=a,e=b,f=!1,g=!1,h=function(a){return g?c(a):a},i={skipNulls:function(){return f=!0,i},nullsToEmpty:function(){return g=!0,i},join:function(a){var b=new Array;return o.eachMap(a,function(a,c){if(!k(a)){if(f&&k(c))return;l(c)?o.each(c,function(c){f&&k(c)||b.push([a,h(c)].join(e))}):b.push([a,h(c)].join(e))}}),b.join(d)}};return i};return{isString:b,isNullOrEmpty:a,nullToEmpty:c,nullTo:d,contains:e,toBoolean:f,Joiner:h,MapJoiner:i,Splitter:g}}(),o=function(){var a=function(){},b=function(b,c){if(!d(b))if(l(b)){if(b.length>0)for(var e=0;e<b.length;e++)try{c(b[e],e)}catch(b){if(b instanceof a)break}}else c(b,0)},c=function(b,c){if(!d(b))for(var e in b)if(b.hasOwnProperty(e))try{c(e,b[e])}catch(b){if(b instanceof a)break}},d=function(a){if(k(a))return!0;if(l(a))return!(a.length>0);try{return!Object.keys(a).length}catch(a){}return!0},e=function(a,b){return!d(a)&&(l(a)?a.indexOf(b)>-1:a.hasOwnProperty(b)&&!k(a[b]))},f=function(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a};return{each:b,eachMap:c,Break:a,isNullOrEmpty:d,contains:e,shuffle:f}}(),p=function(){var a=function(a,b){return k(a)?b:n.isString(a)?n.isNullOrEmpty(a)?b:parseInt(a):a},b=function(b){return a(b,0)};return{nullTo:a,nullToZero:b}}(),q=function(){var a=function(a){return a=p.nullToZero(a),a>=1};return{fromInt:a}}(),r=function(){return Math.floor(9999999999*Math.random())+""},s=function(){return window.self!==window.top},t=s()&&window.name==b+"name",u=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b.toUpperCase()},v=function(a,b){try{if("object"!=typeof a)throw"::mergeObjects() -- Invalid type Error ["+typeof a+"] given as 1st parameter.  Arguments must be of type 'object'";if("object"!=typeof b)throw"::mergeObjects() -- Invalid type Error ["+typeof b+"] given as 2nd parameter.  Arguments must be of type 'object'";var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}catch(a){return i.error(a),null}},w=function(a,b){var c=a();c||setTimeout(function(){w(a,b)},b)},x=function(){var a=5e3,b={},c={},d=function(b,c){var d=(new Date).getTime(),e=!1;return{success:function(){e||(e=!0,setTimeout(b,0))},fail:function(){e||(e=!0,setTimeout(c,0))},isValid:function(){var b=(new Date).getTime();return!e&&b-d<a}}},e=function(a){return!k(window[a])},f=function(a,b){var c=b[a];return k(c)&&(b[a]=c=new Array),c},g=function(a,b){o.isNullOrEmpty(a)&&o.isNullOrEmpty(b)||setTimeout(function(){o.each(a,function(a){a.success()}),o.each(b,function(a){a.fail()})},0)},h=function(a,c,h){var i=d(c,h);if(e(a))i.success();else{var j=f(a,b),k=!1;o.isNullOrEmpty(j)&&(k=!0),j.push(i),b[a]=j,k&&w(function(){var c=e(a),d=new Array,h=new Array,i=new Array,j=f(a,b);return o.each(j,function(a){a.isValid()?c?h.push(a):d.push(a):i.push(a)}),b[a]=d,g(h,i),o.isNullOrEmpty(d)},100)}},i=function(a,b,h){var i=d(b,h);if(e(a)){var j=f(a,c),k=!1;o.isNullOrEmpty(j)&&(k=!0),j.push(i),c[a]=j,k&&w(function(){var b=e(a),d=new Array,h=new Array,i=new Array,j=f(a,c);return o.each(j,function(a){a.isValid()?b?d.push(a):h.push(a):i.push(a)}),c[a]=d,g(h,i),o.isNullOrEmpty(d)},100)}else i.success()};return{whenExists:h,whenDoesntExist:i}}(),y=function(){var a=!1;try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b&&(a=!0)}catch(b){void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&(a=!0)}return a},z=function(){var a;try{a=window.top.location.href}catch(a){i.error(a)}if(!a)try{a=window.location.href}catch(a){i.error(a)}return a||""},A=function(){var a=!1,b=AltitudeDigital.Utils.Url.parse(z()).host;return c.some(function(c){return b.search(c)>=0&&(a=!0,!0)}),a},B=function(){var a=document.referrer;try{a=window.top.document.referrer}catch(b){if(window.parent)try{a=window.parent.document.referrer}catch(a){}}if(!a&&window.opener)try{a=window.opener.location.href}catch(a){}return a||""},C=function(a){var b="",c=a||z();if(null!=c&&""!=c){var d=/:\/\/(.[^\/]+)/;b=c.match(d)[1];for(var e,f=b.split(".").reverse(),g=new Array,h=0;h<f.length&&(e=f[h],g.push(e),2==e.length&&2==String(f[0]).length||!(g.length>1));h++);
b=g.reverse().join(".")}return i("getRootDomain() -> final domain: "+b),b},D=function(){return n.nullToEmpty(document.title)},E=function(a,b,c){return a.addEventListener?(a.addEventListener(b,c,!1),!0):a.attachEvent?a.attachEvent("on"+b,c):(b="on"+b,"function"==typeof a[b]&&(c=function(a,b){return function(){a.apply(this,arguments),b.apply(this,arguments)}}(a[b],c)),a[b]=c,!0)},F=function(a,b,c){return a.removeEventListener?(a.removeEventListener(b,c,!1),!0):a.detachEvent?(a.detachEvent(b,c),!0):void 0},G=function(a,b,c){var d=function(e){F(a,b,d),c(e)};return E(a,b,d)},H=function(a){var b={};return o.each(a.split(";"),function(a){a=a.split(":"),b[a[0]]=a[1]}),b},I=function(a,c,d,e){e=e||"";var f=document.createElement("iframe");return f.src=e||"about:blank",f.id=b+d,f.name=b+"name",f.marginWidth="0",f.marginHeight="0",f.frameBorder="0",f.scrolling="no",f.style&&(f.style.margin="0px",f.style.padding="0px",f.style.border="0px none",f.style.width=a,f.style.height=c,f.style.overflow="hidden"),f},J=function(a,b,c,d){var e="";if(c){var f=a.id;a.style&&(a.style.border="0px none");var g=!1;d=d||1e3,e='<script type="text/javascript">parent.postMessage(\'event:ready;id:'+f+'\', "*");</script>';var h=m(d,function(a){if(!g){var b=H(a.data);if(i("Got iFrame MSG",b),b.id!=f)return;i.custom("iFrame loaded","white","silver"),g=!0,F(window,"message",h),c(!0)}},function(){g||(i("Timeout of iFrame"),g=!0,F(window,"message",h),c(!1))});E(window,"message",h)}var j="<!DOCTYPE html><html><head><title>Altitude Arena</title></head><body style='margin:0;padding:0'>"+b+e+"</body></html>";a=a.contentWindow?a.contentWindow:a.contentDocument.document?a.contentDocument.document:a.contentDocument,a.document.open(),a.document.write(j),a.document.close()},K=function(a){var a=a.replace(/\&amp\;/g,"&").replace(/\&/g,"&amp;");if(window.DOMParser)var b=new DOMParser,c=b.parseFromString(a,"text/xml");else{var c=new ActiveXObject("Microsoft.XMLDOM");c.async="false",c.loadXML(a)}var d=(new XMLSerializer).serializeToString(c);return d},L=function(a,b){if(!k(a)){var c=document.createElement("div");c.innerHTML=b,a.appendChild(c)}},M=function(a,b){return b.parentNode.insertBefore(a,b.nextSibling),!0},N=function(a){k(a)||k(a.parentNode)||a.parentNode.removeChild(a)},O=function(a){for(var b=a,c=0;b&&"body"!==b.tagName.toLowerCase()&&"documentElement"!==b.tagName.toLowerCase();)c+=b.offsetTop,b=b.offsetParent;return c},P=function(a){for(var b=a,c=0;b&&"body"!==b.tagName.toLowerCase()&&"documentElement"!==b.tagName.toLowerCase();)c+=b.offsetLeft,b=b.offsetParent;return c};return{posY:O,posX:P,hasActiveX:a,cb:r,inIframe:s,isOurIframe:t,getPageUrl:z,pt:A,getRefererUrl:B,getRootDomain:C,getPageTitle:D,generateUUID:u,addEventListener:E,removeEventListener:F,addEventListenerOnce:G,createIframe:I,writeIframeContent:J,scrubXMLEncoding:K,enableLogging:j,Exists:x,whenExists:function(a,b,c,d){c?x.whenDoesntExist(a,b,d):x.whenExists(a,b,d)},flashAvailable:y,nl2r:e,log:i,mergeObjects:v,callbackTimeout:m,insertCode:L,appendAfter:M,removeElement:N,isNull:k,isArray:l,Strings:n,Numbers:p,Booleans:q,Iterable:o,break:o.Break,each:o.each}}(),AltitudeDigital.Utils.Url=AltitudeDigital.Utils.Url||function(){var a=AltitudeDigital.Utils,b=a.log,c=a.Strings,d=a.Iterable,e=c.MapJoiner("&","="),f=c.Splitter("&").trimResults().omitEmptyStrings(),g=function(){function c(){}return c.xhr=function(a){a=a||{};var c=a.withCredentials||!1,d=a.timeout||0,e=new window.XMLHttpRequest;if(c)if(b("Looking to use CORS"),"withCredentials"in e)e.withCredentials=!0;else{if("undefined"==typeof XDomainRequest)throw"CORS not supported by browser";e=new XDomainRequest}return e.timeout=d,b("XHR: ",e),e},c.supported=function(){return!!this.xhr()},c.get=function(c,d,e){b("URL: ",c),b("Options: ",d);var f=this.xhr(d);if(f.open("GET",c),f.send(),!a.isNull(e))return f.onreadystatechange=function(){if(4===f.readyState)return e(f.responseText,f.responseXML)}},c.post=function(c,d,e,f){b("URL: ",c),b("Params: ",d),b("Options: ",e);var g=this.xhr(e);if(g.open("POST",c),g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),g.send(l(d)),!a.isNull(f))return g.onreadystatechange=function(){if(4==g.readyState&&200==g.status)return f(g.responseText,g.responseXML)}},c}(),h=function(a,c,d,e){b.startGroup("POST");try{if(!g.supported())throw b.error("XHR not supported"),"XHR isn't supported";g.post(a,c,e,d)}catch(a){throw b.endGroup(),a}b.endGroup()},i=function(a,c,d,e){b.startGroup("GET");try{if(!g.supported())throw b.error("XHR not supported"),"XHR isn't supported";var f=k(a,c);g.get(f,e,d)}catch(a){throw b.endGroup(),a}b.endGroup()},j=function(a,b){var c=k(a,b),d=document.createElement("img");d.src=c},k=function(b,d){if(!a.isNull(d)){var e=l(d,!0);if(!c.isNullOrEmpty(e))return b.indexOf("?")>0?b+"&"+e:b+"?"+e}return b},l=function(b,f){if(!a.isNull(b)){var g={};return 0==f?g=b:d.eachMap(b,function(b,e){a.isArray(e)?(g[b]=new Array,d.each(e,function(a){c.isNullOrEmpty(a)||g[b].push(encodeURIComponent(a))})):c.isNullOrEmpty(e)||(g[b]=encodeURIComponent(e))}),e.join(g)}return""},m=function(b){var e=a.mergeObjects(b||{},{}),g=function(b,c){if(!a.isNull(b))if(d.contains(e,b)){if(!a.isArray(e[b])){var f=e[b];e[b]=new Array,e[b].push(f)}e[b]=e[b].concat(c)}else e[b]=c},h=function(a,b){e[a]=b};return{add:g,set:h,extend:function(a){d.eachMap(a,function(a,b){g(a,b)})},replace:function(a){d.eachMap(a,function(a,b){h(a,b)})},get:function(b){return a.isNull(b)?e:d.contains(e,b)?e[b]:null},toQueryString:function(){return l(e,!0)},remove:function(a){delete e[a]},fromQueryString:function(a){if(!c.isNullOrEmpty(a)){var b=f.split(a);d.each(b,function(a){if(!c.isNullOrEmpty(a)){var b=a.split("=",2);g(b[0],decodeURIComponent(b[1]))}})}}}};return{pixel:j,get:i,post:h,toQueryString:l,addQueryParams:k,ParamCollection:m,parse:function(a){if(c.isNullOrEmpty(a))return null;var b={scheme:"",host:"",path:"",base:"",query:m()},d=a.split("//",2);2==d.length&&(b.scheme=d[0].replace(":",""),a=d[1]);var e="";if(d=a.split("/"),d.length>=2){b.host=d.shift();var f=d.join("/").split("?");2==f.length?(b.path=f[0],e=f[1]):b.path=d[1]}else{var f=a.split("?");2==f.length?(b.host=f[0],e=f[1]):b.host=a}b.query.fromQueryString(e);var g="";return c.isNullOrEmpty(b.scheme)||(g+=b.scheme+"://"),g+=b.host,c.isNullOrEmpty(b.path)||(g+="/"+b.path),b.base=g,b}}}(),AltitudeDigital.ThirdParty=AltitudeDigital.ThirdParty||function(a,b){var c=AltitudeDigital.Utils,d=c.log,e=c.Iterable,f=c.Strings,g=encodeURIComponent(c.getRefererUrl()),h=encodeURIComponent(c.getPageTitle()),i=new Array,j=new Array,k=new Array,l=new Array,m=function(a){d("Loading Pixel: "+a);var b=document.createElement("img");b.src=a},n=function(b){d("Loading JS: "+b);try{if(void 0!==a){var c=document.createElement("script");c.type="text/javascript",c.async=!0,c.src=b,a.appendChild(c)}else document.write("<script async type='text/javascript' src='"+b+"'></script>")}catch(a){}},o=function(a,c,d){return c=encodeURIComponent(f.nullToEmpty(c)),d=encodeURIComponent(f.nullTo(d,c)),a.replace("[page_url]",b).replace("[page_title]",h).replace("[page_referer]",g).replace("[media_name]",d).replace("[media_guid]",c)};return{extendOppPixels:function(a){i=i.concat(a)},extendImpPixels:function(a){j=j.concat(a)},extendOppJS:function(a){k=k.concat(a)},extendImpJS:function(a){l=l.concat(a)},callOps:function(){d("Loading Opp Pixels"),e.each(i,function(a){m(o(a))}),d("Loading Opp JS"),e.each(k,function(a){n(o(a))})},callImps:function(a,b){d("Loading Imp Pixels"),e.each(j,function(c){m(o(c,b,a))}),d("Loading Imp JS"),e.each(l,function(c){n(o(c,b,a))})}}},AltitudeDigital.Beacon=AltitudeDigital.Beacon||function(a,b){var c=AltitudeDigital.Utils,d=c.Strings,e=c.Iterable,f=c.Url,g=c.log,h={attempt:"at",init:"init",trueFirstCall:"dfcl",trueFirstCallVideo:"tfcl",podFirstCall:"pfcl",imp:"rollimp",rollStart:"rollst",roll25:"roll25",roll50:"roll50",roll75:"roll75",roll100:"roll100",click:"rollck",passAway:"pba",passReceived:"pbr",allPartnersFailed:"apf",passToPublisher:"topub",noFlash:"nofl"},i={basic:1,debug:2};g.startGroup("BEACON Info");var j=i.basic,k=f.parse(a),l=k.base;g("Tracking URL: ",a),g("Base Domain: ",l),g("URI Parts: ",k);var m=k.query;g("Base Params from URL: ",m.toQueryString()),m.replace({vpaid:"js",loc:b||c.getPageUrl(),rr:c.getRefererUrl(),dm:c.getRootDomain(b),px:1,v:-1}),g("Final Base Params: ",m.toQueryString()),g.endGroup();var n=function(a){var b=f.ParamCollection();if(!c.isNull(a)){g("Got a component of ",a),b.add("al",a.getAlignmentMeta()),b.add("pm",a.getPlacementMeta());var e=a.getExtensions();c.isNull(e)||(g("Comp Exts: ",a.extensions),d.isNullOrEmpty(e.alignmentMeta)||b.add("al",e.alignmentMeta),d.isNullOrEmpty(e.rtbMeta)||b.add("rm",e.rtbMeta))}return g("Component Params: ",b.get()),b.get()},o=function(a,b){var d=f.ParamCollection(m.get());return c.isArray(a)||c.isNull(a)?b==h.trueFirstCallVideo&&c.isArray(a)&&e.each(a,function(a){c.isNull(a)||d.add("al",a.getAlignmentMeta())}):d.extend(n(a)),d.set("ev",b),g("Request Params: ",d.toQueryString()),d},p=function(a,b,d){if(g.startGroup("Beacon ("+b+")",a),!s(b))return g("not tracking: ",b),void g.endGroup();var e=o(a,b).get();g("Domain: ",l),g("Params: ",e);var h=function(a,b){g("Beacon Response: ",a,b),c.isNull(d)||d(a,b)};try{f.get(l,e,h),g.endGroup()}catch(a){g.error("Post failed. Doing Pixel",a),f.pixel(l,e),g.endGroup(),c.isNull(d)||d()}},q=function(a){var b=o(null,a);return b.set("px",0),f.addQueryParams(l,b.get())},r=function(a,b){var c=o(null,a);return c.set("px",2),c.set("dest",b),f.addQueryParams(l,c.get())},s=function(a){return j!=i.basic||t(a)},t=function(a){switch(a){case h.trueFirstCall:case h.trueFirstCallVideo:case h.podFirstCall:case h.passReceived:case h.imp:case h.rollStart:case h.roll25:case h.roll50:case h.roll75:case h.roll100:case h.click:case h.attempt:return!0}return!1};return{send:p,event:h,genClickURL:q,genClickURLDestination:r,addParam:m.add,setParam:m.set}},AltitudeDigital.EventManager=AltitudeDigital.EventManager||function(){var a=AltitudeDigital.Utils,b=a.log,c={},d=function(a,b,d){"undefined"==typeof c[b]&&(c[b]=new Array),c[b].push({callback:a,scope:d})},e=function(a,b){if("undefined"!=typeof c[b])for(var d=0;d<c[b].length;d++)c[b][d].callback==a&&c[b].splice(d,1)},f=function(a,d){var e=c[a];if("undefined"!=typeof e)try{for(var f=0;f<e.length;f++)g(e[f],d)}catch(a){b.error("Error dispatching event",a)}else b("could not find subscriber '"+e+"' for ["+a+"]")},g=function(a,c){try{"undefined"!=typeof a.scope?a.callback.apply(a.scope,c):a.callback.apply(null,c)}catch(a){b.error("Error dispatching callback",a)}};return{subscribe:d,unsubscribe:e,dispatch:f,unload:function(){c={}}}},AltitudeDigital.Ads=AltitudeDigital.Ads||{ViewMode:{Normal:"normal",Thumbnail:"thumbnail",Fullscreen:"fullscreen"},Events:{AdAttempt:"AdAttempt",AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError"},InternalEvents:{StartAd:"startAdInt",StopAd:"stopAdInt",PauseAd:"pauseAdInt",ResumeAd:"resumeAdInt",ExpandAd:"expandAdInt",SkipAd:"skipAdInt",ChangeVolume:"changeVolumeInt",AdErrorInit:"adErrorInit",AdError:"adErrorInt",ResizeAd:"resizeAdInt",Companions:"companionsInt",Progress:"progressInt"},Handlers:function(){var a={},b=function(b){return a[b]||null};return{register:function(b,c){a[b]=a[b]||c},get:b,has:function(a){return null!=b(a)}}}(),PlayerStatus:function(){var a=null,b=null,c=null,d=null,e=!1,f=null,g=null,h=null;return{getPlayerWidth:function(){return a},setPlayerWidth:function(b){a=b},getPlayerHeight:function(){return b},setPlayerHeight:function(a){b=a},getSlot:function(){return c},setSlot:function(a){c=a},getVideoSlot:function(){return d},setVideoSlot:function(a){d=a},getViewMode:function(){return f},setViewMode:function(a){f=a},getDesiredBitrate:function(){return g},setDesiredBitrate:function(a){g=a},videoCanAutoplay:function(){return e},setVideoCanAutoplay:function(a){e=a},getThirdParty:function(){return h},setThirdParty:function(a){h=a},getMacroObj:function(){return{adtid:transactionId,player_width:a,player_height:b,third_party:h,video_duration:30}}}},ComponentSort:function(a,b){return a.priority>b.priority?1:a.priority<b.priority?-1:a.guaranteed&&b.guaranteed?a.getPrice()>b.getPrice()?-1:a.getPrice()>b.getPrice()?1:a.order>b.order?-1:a.order<b.order?1:0:a.guaranteed?-1:b.guaranteed?1:a.order>b.order?-1:a.order<b.order?1:0}},AltitudeDigital.Ads.Filter=AltitudeDigital.Ads.Filter||function(a,b,c,d){var e=AltitudeDigital.Utils,f=e.Strings,g=e.Booleans,h=e.Numbers,i=e.Iterable,j=e.Url,k=e.log;k("Pasing Filter URI");var l=j.parse(a),m=l.base,n=l.query;k.startGroup("FILTER Info"),k("Base URL: ",a),k("Base Domain: ",m),k("URI Parts: ",l),n.replace({h:c,w:b,v:-1,vpaid:"js",u:d,ru:e.getRefererUrl()}),k("Final Base Params: ",n.toQueryString()),k.endGroup();var o=function(a){j.get(m,n.get(),function(b,c){k("Filter Response recieved. Getting ready to parse."),p(a,b,c)})},p=function(a,b,c){k.startGroup("Filter Response"),k(b);var e={thirdparty:"",filterCodes:"",components:new Array};if(f.isNullOrEmpty(b))k.warn("Response didn't exist");else try{var j=JSON.parse(b);e.thirdparty=f.nullToEmpty(j.tp),e.filterCodes=f.nullToEmpty(j.rcodes),k("Got Thirdparty data of ",e.thirdparty),k("Got Filter code of ",e.filterCodes);var l=j.vmedia,m=j.rmedia,n=j.amedia,o=j.bm,p=j.bp,q=function(a){var b=f.nullToEmpty(a.guid),c=f.nullToEmpty(a.name),i=f.nullToEmpty(a.uri),j=f.nullToEmpty(a.cpm),k=h.nullTo(a.dp,13),l=h.nullToZero(a.dw),m=h.nullToZero(a.do),n=g.fromInt(a.dg),q=f.nullToEmpty(a.pguid),r=AltitudeDigital.Ads.Component(b,c,j,i,k,l,m,n,d);return r.setRtb(!1),r.addAlignmentMeta(a.al),r.addAlignmentMeta(o[q]),r.addPlacementMeta(p[q]),e.components.push(r),r};i.each(l,q),i.each(m,function(a){var b=q(a);b.setRtb(!0)}),i.each(n,function(a){var b=q(a);b.setAsset(!0),b.setAssets(a.assets)})}catch(a){k.error("Error parsing Filter",a)}k("Callback Response is: ",e),k.endGroup(),setTimeout(function(){k("Calling Filter Callback"),a(e)},0)};return{call:o}},AltitudeDigital.Ads.JsVPaidHandler=AltitudeDigital.Ads.JsVPaidHandler||function(a,b,c,d,e,f,g){var h={creative:null,iFrame:null,version:""},i={vpaidLoaded:!1,vpaidStarted:!1,vpaidDestroy:!1},j=AltitudeDigital.Utils,k=j.log,l=AltitudeDigital.Ads,m=l.Events,n=l.InternalEvents,o=[m.AdSkipped,m.AdLinearChange,m.AdDurationChange,m.AdRemainingTimeChange,m.AdImpression,m.AdVideoStart,m.AdVideoFirstQuartile,m.AdVideoMidpoint,m.AdVideoThirdQuartile,m.AdVideoComplete,m.AdClickThru,m.AdInteraction,m.AdUserAcceptInvitation,m.AdUserMinimize,m.AdUserClose,m.AdPaused,m.AdPlaying,m.AdLog],p=[m.AdImpression,m.AdVideoStart,m.AdVideoFirstQuartile,m.AdVideoMidpoint,m.AdVideoThirdQuartile,m.AdVideoComplete],q=[],r=function(a){return!!(a.handshakeVersion&&"function"==typeof a.handshakeVersion&&a.initAd&&"function"==typeof a.initAd&&a.startAd&&"function"==typeof a.startAd&&a.stopAd&&"function"==typeof a.stopAd&&a.skipAd&&"function"==typeof a.skipAd&&a.resizeAd&&"function"==typeof a.resizeAd&&a.pauseAd&&"function"==typeof a.pauseAd&&a.resumeAd&&"function"==typeof a.resumeAd&&a.expandAd&&"function"==typeof a.expandAd&&a.collapseAd&&"function"==typeof a.collapseAd&&a.subscribe&&"function"==typeof a.subscribe&&a.unsubscribe&&"function"==typeof a.unsubscribe)},s=function(){k.custom("Vpaid Loaded","white","silver"),i.vpaidLoaded=!0,a.dispatch(m.AdLoaded),C()},t=function(){i.vpaidStarted=!0,a.dispatch(m.AdStarted)},u=function(){i.vpaidStarted=!1,a.dispatch(m.AdStopped)},v=function(b){k("VPaid reported an error with msg: "+b),i.vpaidStarted?(k("Was started"),a.dispatch(n.AdError,[b])):a.dispatch(n.AdErrorInit,[b])},w=function(){i.vpaidLoaded&&h.creative.pauseAd()},x=function(){i.vpaidLoaded&&h.creative.resumeAd()},y=function(a){i.vpaidLoaded&&(a?h.creative.expandAd():h.creative.collapseAd())},z=function(a,b,c){i.vpaidLoaded&&h.creative.resizeAd(a,b,c)},A=function(a){i.vpaidLoaded&&h.creative.setAdVolume(a)},B=function(){i.vpaidLoaded&&h.creative.getAdSkippableState()&&h.creative.skipAd()},C=function(){a.dispatch(m.AdSkippableStateChange,[h.creative.getAdSkippableState()])},D=function(){i.vpaidDestroy=!0,a.unsubscribe(w,n.PauseAd),a.unsubscribe(x,n.ResumeAd),a.unsubscribe(y,n.ExpandAd),a.unsubscribe(z,n.ResizeAd),a.unsubscribe(A,n.ChangeVolume),a.unsubscribe(B,n.SkipAd);var b=function(){h.iFrame&&(document.body.removeChild(h.iFrame),h.iFrame=null,h.creative=null)};if(i.vpaidStarted){h.creative.subscribe(function(){clearTimeout(b),b()},m.AdStopped);try{h.creative.stopAd(),setTimeout(b,100)}catch(a){b()}}else b()},E=function(b,c,d,e){var f=g.fileURL;h.iFrame=j.createIframe("100%","100%","vpaid-"+Math.floor(100*Math.random()+1)),h.iFrame.style.position="absolute",h.iFrame.style.left="0",h.iFrame.style.top="0",document.body.appendChild(h.iFrame);var i='<script src="'+f+'"></script><div class="ad-element"></div>';j.writeIframeContent(h.iFrame,i,function(f){if(f)try{G(b,c,d,e)}catch(b){a.dispatch(n.AdError,["Error attempting to init VPaid: "+b.message])}else a.dispatch(n.AdError,["iFrame failed to load in time"])},5e3)},F=function(a){return function(){i.vpaidDestroy||a.apply(this,arguments)}},G=function(e,g,i,l){var E=h.iFrame.contentWindow.getVPAIDAd;if(!E||"function"!=typeof E)throw D(),"VPaid is invalid: Can't find VPaid Creative in iFrame";h.creative=E();var G=r(h.creative);if(!G)throw"VPaid is invalid: Missing VPaid interface functions";h.version=h.creative.handshakeVersion("2.0"),k("Vpaid Versions: "+h.version),k("Subscribing to vpaid events"),h.creative.subscribe(F(s),m.AdLoaded),h.creative.subscribe(F(t),m.AdStarted),h.creative.subscribe(F(u),m.AdStopped),h.creative.subscribe(F(v),m.AdError),h.creative.subscribe(F(C),m.AdSkippableStateChange),h.creative.subscribe(F(function(){a.dispatch(n.AdExpandedChange,[h.creative.getAdExpanded()])}),m.AdExpandedChange),h.creative.subscribe(F(function(){a.dispatch(m.AdSizeChange,[h.creative.getAdWidth(),h.creative.getAdHeight()])}),m.AdSizeChange),h.creative.subscribe(F(function(){a.dispatch(m.AdVolumeChange,[h.creative.getAdVolume()])}),m.AdVolumeChange),q=[],j.each(o,function(b){h.creative.subscribe(F(function(){k("Sub VPaid Event: "+b),p.indexOf(b)>-1?q.indexOf(b)>-1?k.custom(b+" has already been dispatched.  Popping bubble.","blue","silver"):(q.push(b),a.dispatch(b,arguments)):a.dispatch(b,arguments)}),b)}),a.subscribe(F(w),n.PauseAd),a.subscribe(F(x),n.ResumeAd),a.subscribe(F(y),n.ExpandAd),a.subscribe(F(z),n.ResizeAd),a.subscribe(F(A),n.ChangeVolume),a.subscribe(F(B),n.SkipAd),k("Subscribing is done");var H={AdParameters:f.adParameters||null},I={slot:b,videoSlot:c,videoSlotCanAutoPlay:d};k("Initializing ad");try{h.creative.initAd(e,g,i,l,H,I),k("Initilized ad. Awaiting adLoaded event.")}catch(a){k("Failed to init js vpaid"),k.error(a)}};return{load:E,start:function(){if(!i.vpaidLoaded)throw"VPaid isn't loaded yet";h.creative.startAd()},destroy:D}},AltitudeDigital.Ads.Handlers.register("text/javascript",AltitudeDigital.Ads.JsVPaidHandler),AltitudeDigital.Ads.Handlers.register("application/javascript",AltitudeDigital.Ads.JsVPaidHandler),AltitudeDigital.Ads.Handlers.register("application/x-javascript",AltitudeDigital.Ads.JsVPaidHandler),AltitudeDigital.Ads.VideoHandler=AltitudeDigital.Ads.VideoHandler||function(a,b,c,d,e,f,g){var h={start:!1,first:!1,second:!1,third:!1,finish:!1},i=!1,j=!1,k=function(){h.finished||(a.dispatch(AltitudeDigital.Ads.Events.AdVideoComplete),h.finished=!0),t()},l=function(){var b="";if(f&&null!=f.videoClickThroughURLTemplate){b=f.videoClickThroughURLTemplate,c.pause();var d=window.open(f.videoClickThroughURLTemplate,"_blank");d.focus()}a.dispatch(AltitudeDigital.Ads.Events.AdClickThru,[b,g.id,!1])},m=function(){a.dispatch(AltitudeDigital.Ads.Events.AdPaused)},n=function(){a.dispatch(AltitudeDigital.Ads.Events.AdPlaying)},o=function(){var b=Math.round(f.duration),d=Math.round(c.currentTime),e=b/4;h.start||(a.dispatch(AltitudeDigital.Ads.Events.AdVideoStart),h.start=!0),!i&&c.currentTime>0&&(a.dispatch(AltitudeDigital.Ads.Events.AdImpression),i=!0),a.dispatch(AltitudeDigital.Ads.InternalEvents.Progress,[d]),d!=Math.round(e)||h.first?d!=Math.round(2*e)||h.second?d!=Math.round(3*e)||h.third||(a.dispatch(AltitudeDigital.Ads.Events.AdVideoThirdQuartile),h.third=!0):(a.dispatch(AltitudeDigital.Ads.Events.AdVideoMidpoint),h.second=!0):(a.dispatch(AltitudeDigital.Ads.Events.AdVideoFirstQuartile),h.first=!0),f&&null!=f.skipDelay&&f.skipDelay>=0&&!j&&f.skipDelay<=d&&a.dispatch(AltitudeDigital.Ads.Events.AdSkippableStateChange,[!0])},p=function(){c.pause()},q=function(){c.play()},r=function(){if(f&&null!=f.skipDelay&&f.skipDelay>=0){var b=Math.round(c.currentTime);f.skipDelay<=b&&(t(!0),a.dispatch(AltitudeDigital.Ads.Events.AdSkipped))}},s=!1,t=function(b){s||(AltitudeDigital.Utils.removeEventListener(c,"click",l),AltitudeDigital.Utils.removeEventListener(c,"ended",k),AltitudeDigital.Utils.removeEventListener(c,"pause",m),AltitudeDigital.Utils.removeEventListener(c,"playing",n),AltitudeDigital.Utils.removeEventListener(c,"timeupdate",o),a.unsubscribe(p,AltitudeDigital.Ads.InternalEvents.PauseAd),a.unsubscribe(q,AltitudeDigital.Ads.InternalEvents.ResumeAd),a.unsubscribe(r,AltitudeDigital.Ads.InternalEvents.SkipAd),b||a.dispatch(AltitudeDigital.Ads.Events.AdStopped),s=!0)};return{load:function(b,d,e,h){c.src=g.fileURL,c.load(),a.dispatch(AltitudeDigital.Ads.Events.AdDurationChange,[f.duration]),a.subscribe(p,AltitudeDigital.Ads.InternalEvents.PauseAd),a.subscribe(q,AltitudeDigital.Ads.InternalEvents.ResumeAd),a.subscribe(r,AltitudeDigital.Ads.InternalEvents.SkipAd),AltitudeDigital.Utils.addEventListener(c,"click",l),AltitudeDigital.Utils.addEventListener(c,"ended",k),AltitudeDigital.Utils.addEventListener(c,"pause",m),AltitudeDigital.Utils.addEventListener(c,"playing",n),AltitudeDigital.Utils.addEventListener(c,"timeupdate",o),a.dispatch(AltitudeDigital.Ads.Events.AdLoaded)},start:function(){c.play(),a.dispatch(AltitudeDigital.Ads.Events.AdStarted)},destroy:t}},AltitudeDigital.Ads.Component=AltitudeDigital.Ads.Component||function(a,b,c,d,e,f,g,h,i){var j=AltitudeDigital.Utils,k=j.Strings,l=j.Numbers,m=j.Iterable,n=j.log,o=null,p=null,q=new Array,r=new Array,s=new Array,t=!1,u=!1,v=new Array,w={fullResponse:null,ad:null,creative:null,mediaFile:null},x=null,y=null,z={bidderPrice:null,bidderId:null,alignmentMeta:null,rtbMeta:null},A=function(){var a=d;try{var b=j.cb(),c=c,e=p.getMacroObj();e.media_file_title="",e.media_file_url="",e.media_description="",e.media_file_id="",e.video_duration=30,e.viewability=-1,e.page_url=encodeURIComponent(c),e.page_url_raw=c,e.random_number=b,e.timestamp=b,e.cb=b,e.bidder_id=k.Joiner(",").join(q),n("Override Macros: ",e),m.eachMap(e,function(b,c){var d=new RegExp("\\["+b+"\\]","g");a=a.replace(d,c)})}catch(a){n.error(a)}return a},B=function(){return j.isNull(y)&&(y=new DMVAST.tracker(w.ad,w.creative)),y},C=function(a,b){n.startGroup("Component::requestAd()");var c=this,e=A();n("Original Url: "+d),n("Formated Url: "+e),n.endGroup(),DMVAST.client.get(e,j.callbackTimeout(a,function(a){n.raw("Component::Response: ",a),n("Self: ",c),a?(c.setVastReponse(a),b(c)):b(null)},function(){n("Vast Response Timed out in "+a+"ms"),b(null)}))},D=function(){if(n("initAd()"),x=G(),!x)throw"No Handler. Init failed.";x.load(p.getPlayerWidth(),p.getPlayerHeight(),p.getViewMode(),p.getDesiredBitrate())},E=function(){x&&x.start()},F=function(){try{x.destroy()}catch(a){n.error(a)}},G=function(){if(n("getHandler()"),null==x)try{var a=AltitudeDigital.Ads.Handlers.get(w.mediaFile.mimeType);if(null==a)throw"Can't get handler for meda type";n("Found a handler. Creating instance."),x=a(o,p.getSlot(),p.getVideoSlot(),p.videoCanAutoplay(),w.ad,w.creative,w.mediaFile)}catch(a){throw n("Failed to getHandler()"),n.raw(a),a}return x};return{id:a,name:b,cpm:c,url:d,priority:e,weight:f,order:g,guaranteed:h,getExtensions:function(){return z},setExtensions:function(a){z=a,"object"==typeof z&&(e=l.nullTo(z.priority,e),f=l.nullTo(z.weight,f))},setEventManager:function(a){o=a},setCurrentPlayerStatus:function(a){p=a},getVastResponse:function(){return w.fullResponse},getAd:function(){return w.ad},getCreative:function(){return w.creative},getMediaFile:function(){return w.mediaFile},setVastReponse:function(a){w.fullResponse=a},setAdInfo:function(a,b,c){w.ad=a,w.creative=b,w.mediaFile=c},setRtb:function(a){t=a},isRtb:function(){return t},setAsset:function(a){u=a},isAsset:function(){return u},setAssets:function(a){v=a},getAssets:function(){return v},requestAd:C,initAd:D,start:E,destroy:F,getTracker:B,getViewability:function(){return j.checkvisible(videoSlot)},getPrice:function(){return null!=z.bidderPrice&&z.bidderPrice>0?z.bidderPrice:c},getAlignmentMeta:function(){return r},addAlignmentMeta:function(a){k.isNullOrEmpty(a)||(n("Adding AlignmentMeta: ",a),r.push(a))},extendAlignmentMeta:function(a){n("Extending AlignmentMeta: ",a),r=r.concat(a),n("Final Meta: ",r)},getPlacementMeta:function(){return s},addPlacementMeta:function(a){k.isNullOrEmpty(a)||(n("Adding PlacementMeta: ",a),s.push(a))},addBidderId:function(a){q.push(a)}}},AltitudeDigital.Ads.Manager=AltitudeDigital.Ads.Manager||function(a,b,c,d,e,f,g,h,i,j,k){var l=AltitudeDigital.Utils,m=l.Strings,n=l.Iterable,o=l.log,p=AltitudeDigital.Ads,q=p.Events;p.Component;o("AdsManager initializing...");var r=p.PlayerStatus();r.setPlayerWidth(f),r.setPlayerHeight(g),r.setSlot(c),r.setVideoSlot(d),r.setVideoCanAutoplay(e),a.subscribe(function(a,c,d){null!=z&&(z.getTracker().click(),b.send(z,b.event.click))},q.AdClickThru),a.subscribe(function(){null!=z&&b.send(z,b.event.attempt)},q.AdAttempt),a.subscribe(function(){null!=z&&b.send(z,b.event.rollStart)},q.AdVideoStart),a.subscribe(function(){null!=z&&b.send(z,b.event.roll25)},q.AdVideoFirstQuartile),a.subscribe(function(){null!=z&&b.send(z,b.event.roll50)},q.AdVideoMidpoint),a.subscribe(function(){null!=z&&b.send(z,b.event.roll75)},q.AdVideoThirdQuartile),a.subscribe(function(){null!=z&&(b.send(z,b.event.roll100),z.getTracker().complete())},q.AdVideoComplete),a.subscribe(function(){null!=z&&(b.send(z,b.event.imp),z.getTracker().load())},q.AdImpression),a.subscribe(function(a){if(null!=z&&null!=z.id){var b=!(a>0);z.getTracker().setMuted(b)}},q.AdVolumeChange),a.subscribe(function(){null!=z&&null!=z.id&&z.getTracker().setPaused(!0)},q.AdPaused),a.subscribe(function(){null!=z&&null!=z.id&&z.getTracker().setPaused(!1)},q.AdPlaying),a.subscribe(function(){null!=z&&null!=z.id&&z.getTracker().stop()},q.AdStopped),a.subscribe(function(){null!=z&&null!=z.id&&z.getTracker().skip()},q.AdSkipped),a.subscribe(function(a){null!=z&&null!=z.id&&z.getTracker().setFullscreen(a)},q.AdExpandedChange),a.subscribe(function(a){null!=z&&null!=z.id&&z.getTracker().setProgress(a)},p.InternalEvents.Progress);var s=function(a){null!=z&&null!=z.id&&z.getTracker().errorWithCode(a)};a.subscribe(s,p.InternalEvents.AdError),a.subscribe(s,p.InternalEvents.AdErrorInit),o("AdsManager initialized");var t={vpaid:k.vpaidTimeout?k.vpaidTimeout:0,broadcast:k.broadcastTimeout?k.broadcastTimeout:0,requestAd:k.adRequestTimeout?k.adRequestTimeout:1e4,adComponent:k.adComponentTimeout?k.adComponentTimeout:0},u=!1,v=!0,w=new Array,x=new Array,y=-1,z=null,A=function(){return z},B=function(){return w};a.subscribe(function(){u=!0,K()},p.InternalEvents.StopAd),a.subscribe(function(){u=!0,o("Skipped. Destorying ad"),K()},q.AdSkipped),a.subscribe(function(){if(z)try{z.start()}catch(b){a.dispatch(q.AdError,["Failed to start ad: "+b.message])}else a.dispatch(q.AdError,["No Component to start"])},p.InternalEvents.StartAd);var C=null,D=!1,E=null,F=function(){o("VPAID Timed out after "+t.vpaid+" ms."),D=!0,K(),a.dispatch(q.AdError,["VPAID Timed out."])},G=function(){o("Ad Playing. Unsubbing and completing ad queue iteration."),v=!1,clearTimeout(C),clearTimeout(E),a.unsubscribe(H,p.InternalEvents.AdError),a.unsubscribe(H,p.InternalEvents.AdErrorInit),a.unsubscribe(G,q.AdPlaying),a.unsubscribe(G,q.AdStarted),a.unsubscribe(H,p.InternalEvents.AdError),a.subscribe(function(b){o("Internal Ad Error: "+b),a.dispatch(q.AdError,[b])},p.InternalEvents.AdError)},H=function(a){o("Component errored: "+a),"string"!=typeof a&&o.raw(a),clearTimeout(E),K(),L()},I=function(){o("AdLoaded. Waiting for Play event."),a.subscribe(G,q.AdPlaying),a.subscribe(G,q.AdStarted),a.subscribe(H,p.InternalEvents.AdError)},J=function(){o("Timeout waiting for component to initialize and play ad after "+t.adComponent+" ms."),K(),L()},K=function(){o("Destorying last component"),z&&(z.destroy(),z=null)},L=function(){o("loadNextAd()");try{if(o("Should try again: "+v+"\nCurrent index: "+y),v&&x.length>++y)if(z=x[y],o.raw("currentComponent: ",z),z)try{t.adComponent>0&&(o("Setting component timeout: "+t.adComponent+" ms"),E=setTimeout(J,t.adComponent)),z.initAd(),o("Ad Initialized. Waiting for AdLoaded event.")}catch(a){o("comp.initAd() error"),o(a),L()}else o("Component was null: "+y),v=!1,a.dispatch(q.AdError,["No Ads (Tried all)"]);else o("Out of components: "+y),a.dispatch(q.AdError,["No Ads (Tried all)"])}catch(b){o.error(b),a.dispatch(q.AdError,["Failed to load next"])}};a.subscribe(I,q.AdLoaded),a.subscribe(H,p.InternalEvents.AdError),a.subscribe(H,p.InternalEvents.AdErrorInit);var M=function(){function b(a){if(c.push(a),c.length==w.length){clearTimeout(e);var b=[];c.forEach(function(a){null!==a&&void 0!==a&&b.push(a)}),D||O(b)}}var c=new Array,d=!1;if(t.vpaid>0&&(o("Setting VPAID Timeout: "+t.vpaid+" ms"),C=setTimeout(F,t.vpaid)),t.broadcast>0){o("Setting broadcast timeout: "+t.broadcast+" ms");var e=setTimeout(function(){d=!0,D||(o("Broadcast timed out after "+t.broadcast+" ms"),O(c))},t.broadcast)}w&&w.length>0?(o("Setting ad request timeout: "+t.requestAd+" ms"),n.each(w,function(a){try{a.isAsset()?b(a):a.requestAd(t.requestAd,function(a){d||b(a)})}catch(a){o(a)}})):a.dispatch(q.AdError,["No Ads (Had None)"])},N=function(){var a=function(a,b){var c=null;return n.each(a.extensions,function(a){if(n.each(a.children,function(a){if(a.name==b)throw c=a.value,l.break()}),null!=c)throw l.break()}),m.nullToEmpty(c)},b=function(b,c){var d=a(b,"Price"),e=a(b,"Bidder"),f=a(b,"Alignment"),g=a(b,"RtbMeta"),h=a(b,"DP"),i=a(b,"DW");c.setExtensions({bidderPrice:d,bidderId:e,alignmentMeta:f,rtbMeta:g,priority:h,weight:i})};return{parseAndSetExtentions:b}}(),O=function(b){o.raw("adResponses ",b),o.endGroup(),u||(b.length<=0?(o.warn("No Ads"),a.dispatch(q.AdError,["No Ads"])):(o.startGroup("Checking all responses"),n.each(b,function(a){function b(a){var b=!1,c=a.mimeType||a.mime;return p.Handlers.has(c)?b=!0:""!=d.canPlayType(c)&&(b=!0,p.Handlers.register(c,p.VideoHandler)),b?(o("Had Handler"),!0):(o("No handler for media of type: "+c),!1)}if(o("Checking response for: "+a.id+"-"+a.name),o.notify("Component: ",a),a.getVastResponse()||a.isAsset()){var c=null;a.isAsset()&&Array.isArray(a.getAssets())?n.each(a.getAssets(),function(d){try{if(b(d)){var e={videoClickThroughURLTemplate:d.clickThroughUrl,duration:d.duration},f={id:a.id,fileURL:d.uri,mimeType:d.mime};throw a.setAdInfo(null,e,f),c=a,new AltitudeDigital.Utils.break}}catch(a){}if(c)throw new AltitudeDigital.Utils.break}):n.each(a.getVastResponse().ads,function(d){if(n.each(d.creatives,function(e){switch(e.type){case"linear":if(n.each(e.mediaFiles,function(f){try{if(b(f))throw a.setAdInfo(d,e,f),N.parseAndSetExtentions(d,a),c=a,
new AltitudeDigital.Utils.break}catch(a){}}),c)throw new AltitudeDigital.Utils.break;break;case"non-linear":break;case"companion":}}),c)throw new AltitudeDigital.Utils.break}),c?(o("We found an ad"),x.push(c)):o("No ad found")}else o("Had no response")}),o("Components Ready: "+x.length),n.isNullOrEmpty(x)?o.endGroup():(x.sort(AltitudeDigital.Ads.ComponentSort),o.notify("componentsReady:",x),o.endGroup(),L())))},P=function(b){o("addComponent("+b.url+")"),o("Status: ",r),b.setEventManager(a),b.setCurrentPlayerStatus(r),w.push(b)};return{addComponent:P,addComponents:function(a){n.each(a,function(a){P(a)})},setThirdParty:function(a){r.setThirdParty(a)},broadcast:M,getComponents:B,getCurrentComponent:A}},AltitudeDigital.VPaid=AltitudeDigital.VPaid||function(){var a=AltitudeDigital.EventManager(),b=AltitudeDigital.EventManager(),c=200,d=null,e=null,f=null,d=null,g=AltitudeDigital.Utils,h=g.Strings,i=(g.Numbers,g.Iterable),j=(g.Url,AltitudeDigital.Ads.Events),k=AltitudeDigital.Utils.log,l={width:0,height:0,viewMode:AltitudeDigital.Ads.ViewMode.Normal,desiredBitrate:0,slot:null,videoSlot:null,videoSlotCanAutoPlay:null},m={width:0,height:0,skippable:!1,duration:-2,remaingTime:-2,expanded:!1,viewMode:AltitudeDigital.Ads.ViewMode.Normal,volume:-1,companions:""},n=[j.AdLoaded,j.AdStarted,j.AdLinearChange,j.AdRemainingTimeChange,j.AdVolumeChange,j.AdImpression,j.AdVideoStart,j.AdVideoFirstQuartile,j.AdVideoMidpoint,j.AdVideoThirdQuartile,j.AdVideoComplete,j.AdClickThru,j.AdInteraction,j.AdUserAcceptInvitation,j.AdUserMinimize,j.AdUserClose,j.AdPaused,j.AdPlaying,j.AdLog,j.AdError];return k("Subing Int->Player bubble events"),i.each(n,function(c){a.subscribe(function(){k.notify("Bubbling ("+c+") with args: ",arguments),b.dispatch(c,arguments)},c)}),a.subscribe(function(a){k.error("VPaidJS Error from below",a)},j.AdError),a.subscribe(function(a,c){m.width=a,m.height=c,b.dispatch(j.AdSizeChange)},j.AdSizeChange),a.subscribe(function(a){m.expanded=a,b.dispatch(j.AdExpandedChange)},j.AdExpandedChange),a.subscribe(function(a){m.duration=a,b.dispatch(j.AdDurationChange)},j.AdDurationChange),a.subscribe(function(){setTimeout(function(){b.dispatch(j.AdSkipped),b.dispatch(j.AdStopped)},c)},j.AdSkipped),a.subscribe(function(a){m.skippable!=a&&(m.skippable=a,b.dispatch(j.AdSkippableStateChange))},j.AdSkippableStateChange),a.subscribe(function(){setTimeout(function(){b.dispatch(j.AdStopped)},c)},j.AdStopped),a.subscribe(function(a){m.companions=a},AltitudeDigital.Ads.InternalEvents.Companions),a.subscribe(function(){d&&d.callImps()},j.AdImpression),{getAdLinear:function(){return!0},getAdWidth:function(){return m.width},getAdHeight:function(){return m.height},getAdExpanded:function(){return m.expanded},getAdSkippableState:function(){return m.skippable},getAdRemainingTime:function(){return m.remaingTime},getAdDuration:function(){return m.duration},getAdVolume:function(){return m.volume},setAdVolume:function(b){m.volume=b,a.dispatch(AltitudeDigital.Ads.InternalEvents.ChangeVolume,[b])},getAdCompanions:function(){return m.companions},getAdIcons:function(){return!1},handshakeVersion:function(a){return"2.0"},initAd:function(c,n,o,p,q,r){l.width=c,l.height=n,l.viewMode=o,l.desiredBitrate=p,m.width=c,m.height=n,m.viewMode=o,q=q||{},r=r||{},l.slot=r.slot||null,l.videoSlot=r.videoSlot||null,l.videoSlotCanAutoPlay=r.videoSlotCanAutoPlay||!0;var s=q.AdParameters||q.adParameters||null;if(h.isNullOrEmpty(s))return b.dispatch(j.AdError,["No AdParams provided"]),!1;s.indexOf("{{|}}")!=-1&&(s=s.substr(0,s.indexOf("{{|}}")));var t=JSON.parse(s),u=t.params;h.toBoolean(u.log)&&g.enableLogging(!0);var v,w=function(){var a=g.Url.parse(u.furi);if(null!=a){var b=a.query.get("pu");if(Array.isArray(b)&&b.length>0)return decodeURIComponent(b[0]);if("string"==typeof b&&!g.Strings.isNullOrEmpty(b))return decodeURIComponent(b)}return null};g.pt()&&(v=w()),v||(v=g.getPageUrl());var x=u.vto,y=u.bto,z=u.rto,A=u.cto,B=t.calls;d=AltitudeDigital.ThirdParty(l.slot,v),d.extendOppPixels(B.op),d.extendImpPixels(B.ip),d.extendOppJS(B.oj),d.extendImpJS(B.ij),d.callOps(),k.startGroup("VPaid INITAd"),k.black("Player Config",l),k.black("configJSON: ",t),k("Building out Beacon"),e=AltitudeDigital.Beacon(u.evuri,v),e.addParam("sw",c),e.addParam("sh",n),k.raw("Beacon: ",e),k("Creating Manager");var C={vpaidTimeout:x,broadcastTimeout:y,adRequestTimeout:z,adComponentTimeout:A};f=AltitudeDigital.Ads.Manager(a,e,l.slot,l.videoSlot,l.videoSlotCanAutoPlay,c,n,o,p,v,C),k.endGroup(),k("Creating Filter Call");try{var D=AltitudeDigital.Ads.Filter(u.furi,c,n,v);k("Calling out to Filter"),D.call(function(a){k.startGroup("FilterResponse Callback");var b=a.thirdparty,c=a.filterCodes,d=a.components;k("Thirdparty: ",b),k("Filter Codes: ",c),k("Components: ",d),e.addParam("tp",b),e.addParam("fc",c),f.setThirdParty(b),i.each(d,function(a){f.addComponent(a)}),k.endGroup(),k("Starting Broadcast"),f.broadcast()})}catch(a){k.error("Failed to call Filter",a)}},resizeAd:function(b,c,d){l.width=b,l.height=c,l.viewMode=d,a.dispatch(AltitudeDigital.Ads.InternalEvents.ResizeAd,[b,c,d])},startAd:function(){k("startAd()"),a.dispatch(AltitudeDigital.Ads.InternalEvents.StartAd)},stopAd:function(){k("stopAd()"),a.dispatch(AltitudeDigital.Ads.InternalEvents.StopAd)},pauseAd:function(){k("pauseAd()"),a.dispatch(AltitudeDigital.Ads.InternalEvents.PauseAd)},resumeAd:function(){k("resumeAd()"),a.dispatch(AltitudeDigital.Ads.InternalEvents.ResumeAd)},expandAd:function(){a.dispatch(AltitudeDigital.Ads.InternalEvents.ExpandAd,[!0])},collapseAd:function(){a.dispatch(AltitudeDigital.Ads.InternalEvents.ExpandAd,[!1])},skipAd:function(){m.skippable&&a.dispatch(AltitudeDigital.Ads.InternalEvents.SkipAd)},subscribe:function(a,c,d){b.subscribe(a,c,d)},unsubscribe:function(a,c){b.unsubscribe(a,c)}}},window.getVPAIDAd=window.getVPAIDAd||function(){return AltitudeDigital.VPaid()};